### R QUIZ 5 - CHARLIE MEYER - ABS6BD ###

library("pracma")

### QUESTION 1 ###

entries = c(2, 1, -3, 1,   1, 0, 4, -2,   -3, 4, -1, 0,   1, -2, 0, 5)
A = matrix(entries, nrow=4)

D = diag(eigen(A)$values)
D

P = eigen(A)$vectors
P

check_result = P %*% D %*% t(P)

#####################################
### CONSOLE OUTPUT FOR QUESTION 1 ###
#####################################

# > P = eigen(A)$vectors
# > P
# [,1]       [,2]      [,3]       [,4]
# [1,]  0.3179612 -0.6385084 0.6000627  0.3621222
# [2,] -0.4084564  0.1075959 0.6874392 -0.5907740
# [3,] -0.3472819  0.5274074 0.3186140  0.7069101
# [4,]  0.7819587  0.5500651 0.2565878 -0.1418862

# > D = diag(eigen(A)$values)
# > D
# [,1]     [,2]    [,3]      [,4]
# [1,] 6.451322 0.000000 0.00000  0.000000
# [2,] 0.000000 3.448002 0.00000  0.000000
# [3,] 0.000000 0.000000 1.98031  0.000000
# [4,] 0.000000 0.000000 0.00000 -5.879634


### QUESTION 2 ###

x = c(17.9, 8.9, 14.7, 5.4, 11.5, 13.4, 17.7, 13.6, 8.5, 7.3, 4.4, 16.8, 15.7)
y = c(43.1, 26.7, 32.8, 21.0, 42.2, 31.4, 42.8, 38.7, 37.9, 23.8, 24.2, 46.1, 39.5)

A = matrix(NA, nrow = 13, ncol = 2)

A[, 1] = x
A[,2] = rep(1, 13)

solve(t(A) %*% A) %*% t(A) %*% y

#####################################
### CONSOLE OUTPUT FOR QUESTION 2 ###
#####################################
# [,1]
# [1,]  1.515729 
# [2,] 16.465345
## NOTE FOR GRADER: 1.515729 is the slope, 16.465345 is the intercept. ##